# 彩票中奖检查接口使用说明

## 接口地址

`POST /lottery/check`

## 功能说明

检查写死的购买号码是否中奖。**支持批量多期检测**，系统内置了固定的购买号码，用户可以一次性输入多期的中奖号码进行批量检测。

## 写死的购买号码

### 双色球
- **红球**: 01, 05, 09, 15, 19, 30
- **蓝球**: 05

### 大乐透
- **前区**: 05, 09, 15, 19, 30
- **后区**: 02, 10

## 请求参数

### 单期检查双色球

```json
{
  "lotteryType": "双色球",
  "winningSSQ": [
    {
      "redBalls": [1, 5, 9, 15, 19, 30],
      "blueBall": 5
    }
  ]
}
```

### 批量检查双色球（多期）

```json
{
  "lotteryType": "双色球",
  "winningSSQ": [
    {
      "redBalls": [1, 5, 9, 15, 19, 30],
      "blueBall": 5
    },
    {
      "redBalls": [2, 8, 12, 18, 25, 32],
      "blueBall": 10
    },
    {
      "redBalls": [3, 7, 11, 16, 22, 28],
      "blueBall": 3
    }
  ]
}
```

### 单期检查大乐透

```json
{
  "lotteryType": "大乐透",
  "winningDLT": [
    {
      "frontZone": [5, 9, 15, 19, 30],
      "backZone": [2, 10]
    }
  ]
}
```

### 批量检查大乐透（多期）

```json
{
  "lotteryType": "大乐透",
  "winningDLT": [
    {
      "frontZone": [5, 9, 15, 19, 30],
      "backZone": [2, 10]
    },
    {
      "frontZone": [1, 8, 12, 20, 25],
      "backZone": [3, 7]
    },
    {
      "frontZone": [6, 10, 14, 22, 31],
      "backZone": [1, 11]
    }
  ]
}
```

## 响应格式

### 单期响应示例

```json
{
  "code": 0,
  "data": {
    "lotteryType": "双色球",
    "totalPeriods": 1,
    "winningCount": 1,
    "results": [
      {
        "period": 1,
        "purchasedNumbers": {
          "redBalls": [1, 5, 9, 15, 19, 30],
          "blueBall": 5
        },
        "winningNumbers": {
          "redBalls": [1, 5, 9, 15, 19, 30],
          "blueBall": 5
        },
        "isWinning": true,
        "prize": "一等奖",
        "prizeLevel": 1,
        "matchDetail": "红球匹配6个，蓝球匹配"
      }
    ]
  },
  "msg": "检查成功"
}
```

### 多期响应示例

```json
{
  "code": 0,
  "data": {
    "lotteryType": "双色球",
    "totalPeriods": 3,
    "winningCount": 2,
    "results": [
      {
        "period": 1,
        "purchasedNumbers": {
          "redBalls": [1, 5, 9, 15, 19, 30],
          "blueBall": 5
        },
        "winningNumbers": {
          "redBalls": [1, 5, 9, 15, 19, 30],
          "blueBall": 5
        },
        "isWinning": true,
        "prize": "一等奖",
        "prizeLevel": 1,
        "matchDetail": "红球匹配6个，蓝球匹配"
      },
      {
        "period": 2,
        "purchasedNumbers": {
          "redBalls": [1, 5, 9, 15, 19, 30],
          "blueBall": 5
        },
        "winningNumbers": {
          "redBalls": [2, 8, 12, 18, 25, 32],
          "blueBall": 10
        },
        "isWinning": false,
        "prize": "未中奖",
        "prizeLevel": 0,
        "matchDetail": "红球匹配0个，蓝球未匹配"
      },
      {
        "period": 3,
        "purchasedNumbers": {
          "redBalls": [1, 5, 9, 15, 19, 30],
          "blueBall": 5
        },
        "winningNumbers": {
          "redBalls": [1, 5, 9, 12, 20, 28],
          "blueBall": 5
        },
        "isWinning": true,
        "prize": "五等奖",
        "prizeLevel": 5,
        "matchDetail": "红球匹配3个，蓝球匹配"
      }
    ]
  },
  "msg": "检查成功"
}
```

## 使用示例

### 1. 单期检查双色球

```bash
curl -X POST http://localhost:8888/lottery/check \
  -H "Content-Type: application/json" \
  -d '{
    "lotteryType": "双色球",
    "winningSSQ": [
      {
        "redBalls": [1, 5, 9, 15, 19, 30],
        "blueBall": 5
      }
    ]
  }'
```

### 2. 批量检查双色球（3期）

```bash
curl -X POST http://localhost:8888/lottery/check \
  -H "Content-Type: application/json" \
  -d '{
    "lotteryType": "双色球",
    "winningSSQ": [
      {
        "redBalls": [1, 5, 9, 15, 19, 30],
        "blueBall": 5
      },
      {
        "redBalls": [2, 8, 12, 18, 25, 32],
        "blueBall": 10
      },
      {
        "redBalls": [1, 5, 9, 12, 20, 28],
        "blueBall": 5
      }
    ]
  }'
```

### 3. 批量检查大乐透（5期）

```bash
curl -X POST http://localhost:8888/lottery/check \
  -H "Content-Type: application/json" \
  -d '{
    "lotteryType": "大乐透",
    "winningDLT": [
      {"frontZone": [5, 9, 15, 19, 30], "backZone": [2, 10]},
      {"frontZone": [1, 8, 12, 20, 25], "backZone": [3, 7]},
      {"frontZone": [6, 10, 14, 22, 31], "backZone": [1, 11]},
      {"frontZone": [5, 9, 15, 19, 30], "backZone": [2, 5]},
      {"frontZone": [3, 7, 13, 21, 28], "backZone": [4, 8]}
    ]
  }'
```

## JavaScript 调用示例

### 单期检测

```javascript
async function checkSinglePeriod() {
  const response = await fetch('http://localhost:8888/lottery/check', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
    },
    body: JSON.stringify({
      lotteryType: '双色球',
      winningSSQ: [
        {
          redBalls: [1, 5, 9, 15, 19, 30],
          blueBall: 5
        }
      ]
    })
  });
  
  const result = await response.json();
  
  if (result.code === 0) {
    const data = result.data;
    console.log(`检测了 ${data.totalPeriods} 期，中奖 ${data.winningCount} 期`);
    
    data.results.forEach(period => {
      console.log(`第${period.period}期: ${period.prize} - ${period.matchDetail}`);
    });
  }
  
  return result;
}
```

### 批量多期检测

```javascript
async function checkMultiplePeriods() {
  // 准备多期中奖号码
  const periods = [
    { redBalls: [1, 5, 9, 15, 19, 30], blueBall: 5 },
    { redBalls: [2, 8, 12, 18, 25, 32], blueBall: 10 },
    { redBalls: [1, 5, 9, 12, 20, 28], blueBall: 5 },
    { redBalls: [3, 7, 11, 16, 22, 29], blueBall: 8 },
    { redBalls: [4, 6, 10, 14, 21, 31], blueBall: 12 }
  ];
  
  const response = await fetch('http://localhost:8888/lottery/check', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
    },
    body: JSON.stringify({
      lotteryType: '双色球',
      winningSSQ: periods
    })
  });
  
  const result = await response.json();
  
  if (result.code === 0) {
    const data = result.data;
    console.log(`总计: 检测 ${data.totalPeriods} 期，中奖 ${data.winningCount} 期`);
    console.log('中奖率:', (data.winningCount / data.totalPeriods * 100).toFixed(2) + '%');
    
    // 显示中奖期数
    const winningPeriods = data.results.filter(r => r.isWinning);
    console.log('中奖期数:', winningPeriods.map(r => `第${r.period}期(${r.prize})`).join(', '));
  }
  
  return result;
}
```

## Python 调用示例

```python
import requests

def check_lottery_batch(lottery_type, winning_numbers_list):
    """批量检查彩票"""
    url = 'http://localhost:8888/lottery/check'
    
    data = {
        'lotteryType': lottery_type,
    }
    
    if lottery_type == '双色球':
        data['winningSSQ'] = winning_numbers_list
    else:
        data['winningDLT'] = winning_numbers_list
    
    response = requests.post(url, json=data)
    result = response.json()
    
    if result['code'] == 0:
        data = result['data']
        print(f"总计: 检测 {data['totalPeriods']} 期，中奖 {data['winningCount']} 期")
        print(f"中奖率: {data['winningCount'] / data['totalPeriods'] * 100:.2f}%")
        print("\n详细结果:")
        
        for period in data['results']:
            status = "✓ 中奖" if period['isWinning'] else "✗ 未中奖"
            print(f"第{period['period']:2d}期: {status:8s} {period['prize']:8s} - {period['matchDetail']}")
    
    return result

# 示例1: 检查单期
check_lottery_batch('双色球', [
    {'redBalls': [1, 5, 9, 15, 19, 30], 'blueBall': 5}
])

# 示例2: 批量检查5期
winning_numbers = [
    {'redBalls': [1, 5, 9, 15, 19, 30], 'blueBall': 5},
    {'redBalls': [2, 8, 12, 18, 25, 32], 'blueBall': 10},
    {'redBalls': [1, 5, 9, 12, 20, 28], 'blueBall': 5},
    {'redBalls': [3, 7, 11, 16, 22, 29], 'blueBall': 8},
    {'redBalls': [4, 6, 10, 14, 21, 31], 'blueBall': 12}
]

check_lottery_batch('双色球', winning_numbers)
```

## 响应字段说明

### 顶层字段

| 字段 | 类型 | 说明 |
|------|------|------|
| `lotteryType` | string | 彩票类型 |
| `totalPeriods` | int | 总共检测的期数 |
| `winningCount` | int | 中奖的期数 |
| `results` | array | 每期的详细检测结果 |

### PeriodResult 字段（单期结果）

| 字段 | 类型 | 说明 |
|------|------|------|
| `period` | int | 期号（从1开始） |
| `purchasedNumbers` | object | 购买的号码（固定） |
| `winningNumbers` | object | 本期中奖号码 |
| `isWinning` | bool | 是否中奖 |
| `prize` | string | 奖项名称 |
| `prizeLevel` | int | 奖项等级（1-9，0表示未中奖） |
| `matchDetail` | string | 匹配详情 |

## 奖项规则

### 双色球奖项

| 奖项 | 条件 |
|------|------|
| 一等奖 | 6个红球 + 1个蓝球 |
| 二等奖 | 6个红球 |
| 三等奖 | 5个红球 + 1个蓝球 |
| 四等奖 | 5个红球 或 4个红球+1个蓝球 |
| 五等奖 | 4个红球 或 3个红球+1个蓝球 |
| 六等奖 | 1个蓝球 |

### 大乐透奖项

| 奖项 | 条件 |
|------|------|
| 一等奖 | 5个前区 + 2个后区 |
| 二等奖 | 5个前区 + 1个后区 |
| 三等奖 | 5个前区 + 0个后区 |
| 四等奖 | 4个前区 + 2个后区 |
| 五等奖 | 4个前区 + 1个后区 |
| 六等奖 | 3个前区 + 2个后区 |
| 七等奖 | 4个前区 + 0个后区 |
| 八等奖 | 3个前区+1个后区 或 2个前区+2个后区 |
| 九等奖 | 3个前区+0个后区 或 1个前区+2个后区 或 2个前区+1个后区 或 0个前区+2个后区 |

## 错误处理

### 未提供中奖号码

```json
{
  "code": 7,
  "data": {},
  "msg": "双色球类型必须提供至少一期中奖号码"
}
```

### 号码格式错误

```json
{
  "code": 7,
  "data": {},
  "msg": "第2期号码格式错误: 双色球红球必须是6个"
}
```

### 号码超出范围

```json
{
  "code": 7,
  "data": {},
  "msg": "第1期号码格式错误: 双色球红球号码必须在1-33之间，当前值: 40"
}
```

## 实际应用场景

### 场景1: 每日自动检测

```javascript
// 每天定时检测最新一期
async function dailyCheck() {
  // 从彩票官网获取最新开奖号码
  const latestWinning = await fetchLatestWinningNumbers();
  
  // 检测是否中奖
  const result = await checkLottery('双色球', [latestWinning]);
  
  if (result.data.winningCount > 0) {
    // 发送中奖通知
    sendNotification('恭喜中奖！', result.data.results[0]);
  }
}
```

### 场景2: 历史数据批量检测

```javascript
// 检测过去30期
async function checkHistory() {
  // 获取过去30期的开奖号码
  const history = await fetchWinningHistory(30);
  
  // 批量检测
  const result = await checkLottery('双色球', history);
  
  // 统计分析
  console.log(`中奖次数: ${result.data.winningCount}`);
  console.log(`中奖率: ${(result.data.winningCount / 30 * 100).toFixed(2)}%`);
  
  // 显示所有中奖期数
  result.data.results
    .filter(r => r.isWinning)
    .forEach(r => {
      console.log(`第${r.period}期: ${r.prize}`);
    });
}
```

### 场景3: 一年数据统计

```python
def annual_statistics():
    """统计一年的中奖情况"""
    # 获取一年的开奖数据（假设一周3期，一年约156期）
    winning_numbers = fetch_annual_winning_numbers()
    
    result = check_lottery_batch('双色球', winning_numbers)
    
    if result['code'] == 0:
        data = result['data']
        
        # 统计各奖项数量
        prize_count = {}
        for period in data['results']:
            if period['isWinning']:
                prize = period['prize']
                prize_count[prize] = prize_count.get(prize, 0) + 1
        
        print(f"年度统计报告:")
        print(f"总期数: {data['totalPeriods']}")
        print(f"中奖期数: {data['winningCount']}")
        print(f"中奖率: {data['winningCount'] / data['totalPeriods'] * 100:.2f}%")
        print(f"\n奖项分布:")
        for prize, count in sorted(prize_count.items()):
            print(f"  {prize}: {count}次")
```

## 性能说明

- **单期检测**: 响应时间 < 10ms
- **10期批量**: 响应时间 < 20ms
- **100期批量**: 响应时间 < 100ms
- **1000期批量**: 响应时间 < 500ms

建议单次请求不超过 1000 期。

## 注意事项

1. **购买号码固定**: 系统使用固定的购买号码，无法修改
2. **支持批量检测**: 可以一次性检测多期，提高效率
3. **期号自动编号**: 系统会自动为每期分配期号（从1开始）
4. **号码格式要求**:
   - 双色球：6个红球（1-33）+ 1个蓝球（1-16）
   - 大乐透：5个前区（1-35）+ 2个后区（1-12）
5. **号码不能重复**: 同一区域的号码不能重复
6. **建议批量大小**: 单次请求建议不超过1000期

## 优势特点

✅ **批量检测**: 一次可检测多期，节省请求次数  
✅ **自动统计**: 自动统计总期数和中奖期数  
✅ **详细结果**: 每期都有详细的匹配信息  
✅ **性能高效**: 批量检测性能优秀  
✅ **易于集成**: 简单的 REST API  

## 修改记录

- 2024-12-22: **支持批量多期检测**，可一次性检测多期彩票
- 2024-12-22: 简化接口，将购买号码写死，只需传入中奖号码
- 原版本: 需要用户同时提供购买号码和中奖号码
